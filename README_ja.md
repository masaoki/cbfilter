# cbfilter

AI モデルを使用してクリップボードの内容を処理する Windows 用のクリップボード変換ユーティリティ。シンプルなホットキーで、定義に沿ってテキストや画像を AI 搭載のさまざまなフィルターで変換します。

## 機能

- **テキスト処理**: AI 言語モデルを使用してテキストを翻訳、要約、変換します
- **画像処理**: 視覚モデルを用いて画像を分析するか、テキストから画像を生成します
- **複数の AI モデル**: 複数のモデルエンドポイントを設定します（OpenAI、ローカルサーバー等）
- **カスタムフィルター**: 自分のプロンプトでカスタム変換フィルターを作成します
- **通知領域統合**: 通知領域アイコンとともにバックグラウンドで動作します
- **ホットキー対応**: `Win+Alt+V` を押してフィルターメニューを表示し、クリップボードを処理します
- **設定の永続化**: 設定は `%APPDATA%\cbfilter\config.json` ファイルに保存されます

## 対応変換

本アプリケーションは4種類の変換をサポートします：

1. **テキスト → テキスト**: テキストの補完、翻訳、要約など
2. **テキスト → 画像**: テキストプロンプトから画像を生成
3. **画像 → テキスト**: 画像を分析してテキストの説明を抽出
4. **画像 → 画像**: AI モデルを使って画像を変換

## 要件

- Windows 10 以降
- C++20 に対応したコンパイラ（MSVC、MinGW など）
- Windows SDK

## ビルド

次を実行します：
```bash
build.bat
```

デバッグログはビルドオプションで有効化されます。

```bash
build.bat debug
```

## 設定

初回起動時に設定ダイアログが表示されます。これらのファイルを直接編集するか、設定ダイアログを使用できます。
設定は `%APPDATA%\cbfilter\config.json` に保存されます。設定ファイルが存在しない場合にのみ設定ダイアログが表示されます。

### 言語設定

以下の言語をサポートしています。

- English → 英語
- Japanese → 日本語
- German → ドイツ語
- Spanish → スペイン語
- French → フランス語
- Italian → イタリア語
- Korean → 韓国語
- Dutch → オランダ語
- Portuguese → ポルトガル語
- Russian → ロシア語
- Thai → タイ語
- Vietnamese → ベトナム語
- Chinese → 中国語

セットアップダイアログで言語を変更できますが、デフォルト設定は `defconf.json` ファイルに依存します。インストーラーはインストール言語用のデフォルト設定を `defconf.json` としてインストールします。

### ホットキー設定

ホットキー設定はセットアップダイアログで変更できます。 また、`%APPDATA%\cbfilter\config.json` にも保存されます。

### モデル設定

各モデルには次の情報が必要です：
- **名称**: モデルの表示名
- **サーバーURL**: API エンドポイント（例：`https://api.openai.com/v1`）
- **モデル名**: モデル識別子（例：`gpt-5.1`、`gpt-image-1`）
- **APIキー**: API の認証キー

### フィルター設定

各フィルターには以下が必要です：
- **タイトル**: フィルターメニューに表示される表示名
- **入力タイプ**: テキストまたは画像
- **出力タイプ**: テキストまたは画像
- **モデル**: 使用する AI モデル
- **プロンプト**: AI モデルへ送信する指示文

## 使い方

1. **アプリケーションを起動する**: `cbfilter.exe` を実行します。通知領域に表示されます。

2. **モデルとフィルターを設定する**: 
   - 通知領域のアイコンを右クリックして「Settings」を選択
   - 必要に応じてモデルとフィルターを追加または編集

3. **フィルターを使用する**:
   - テキストまたは画像をクリップボードにコピー
   - `Win+Alt+V` を押してフィルターメニューを表示
   - メニューからフィルターを選択
   - クリップボードは変換後の内容に置換される
   - 結果は自動的に貼り付けられる（Ctrl+V の模倣）

4. **通知領域メニュー**:
   - 右クリック: 設定メニューを表示
   - ダブルクリック: 設定ウィンドウを開く
   - 左クリック: フィルターメニューを表示（クリップボードが適合する内容を含む場合）

## ロギング

デバッグ用ビルドの `cbfilter.exe` のみ、デバッグログ `cbfilter.log` が作成されます。

## API 互換性

本アプリは OpenAI API 形式、または Google Gemini API 形式と互換性があります。API 構造はテンプレート `apidefs/<Provider_Name>.json` ファイルの中にあります。現在 OpenAI、Gemini、OpenRouter の設定が含まれています。OpenAI の設定は LiteLLM Proxy、Requesty など OpenAI 互換 API の大半に適合します。有用な API プロバイダ定義テンプレートを作成した場合はお知らせください。

## ライセンス

本プロジェクトは MIT ライセンスの下で提供されています。